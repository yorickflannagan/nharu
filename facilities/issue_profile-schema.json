{
	"definitions": {},
	"$schema": "http://json-schema.org/draft-07/schema#",
	"$id": "http://caixa.gov.br/cert-profile.json",
	"type": "object",
	"title": "Certificate Profile",
	"required": [
		"version",
		"serialNumber",
		"signature",
		"issuer",
		"validity",
		"subject",
		"subjectPublicKeyInfo",
		"extensions"
	],
	"properties": {
		"version": {
			"$id": "#/properties/version",
			"type": "integer",
			"title": "Certificate version",
			"description": "Version ::= INTEGER  {  v1(0), v2(1), v3(2)  }",
			"default": 0,
			"examples": [ "2" ]
		},
		"serialNumber": {
			"$id": "#/properties/serialNumber",
			"type": "hexadecimal string",
			"title": "Certificate serial number",
			"description": "CertificateSerialNumber ::= INTEGER as a hexadecimal value",
			"default": null,
			"examples": [ "604C010304A034043231" ],
			"pattern": "^([A-F,a-f,0-9]*)$"
		},
		"signature": {
			"$id": "#/properties/signature",
			"type": "object",
			"title": "Certificate signature algorithm identifier",
			"description": "CertificateSerialNumber ::= INTEGER",
			"required": [ "algorithm" ],
			"properties": {
				"algorithm": {
					"$id": "#/properties/signature/properties/algorithm",
					"type": "array of numbers",
					"title": "Algorithm identifier",
					"description": "OBJECT IDENTIFIER as an array of numbers",
					"examples": [ "[1, 2, 840, 113549, 1, 1, 11]" ]
				},
				"parameters": {
					"$id": "#/properties/signature/properties/parameters",
					"type": "any",
					"title": "Algorithm parameters"
				}
			}
		},
		"issuer": {
			"$id": "#/properties/issuer",
			"type": "array",
			"title": "Certificate issuer",
			"description": "X.500 Name",
			"items": {
				"$id": "#/properties/issuer/items",
				"type": "object",
				"title": "The Items Schema",
				"required": [ "oid", "value" ],
				"properties": {
					"oid": {
						"$id": "#/properties/issuer/items/properties/oid",
						"type": "array of numbers",
						"title": "Name object identifier",
						"description": "OBJECT IDENTIFIER as an array of number",
						"examples": [ "[ 2, 5, 4, 6 ]" ]
					},
					"value": {
						"$id": "#/properties/issuer/items/properties/value",
						"type": "string",
						"title": "Name value",
						"examples": [ "BR" ]
					}
				}
			}
		},
		"validity": {
			"$id": "#/properties/validity",
			"type": "object",
			"title": "Certificate Validity",
			"description": "Validity ::= SEQUENCE { notBefore GeneralizedTime, notAfter GeneralizedTime }",
			"required": [ "notBefore", "notAfter" ],
			"properties": {
				"notBefore": {
					"$id": "#/properties/validity/properties/notBefore",
					"type": "string",
					"title": "Certificate validity start date and time",
					"examples": [ "20180925173943Z" ],
					"pattern": "YYYYMMDDHHSSZ"
				},
				"notAfter": {
					"$id": "#/properties/validity/properties/notAfter",
					"type": "string",
					"title": "Certificate validity start date and time",
					"examples": [ "20190925173943Z" ],
					"pattern": "YYYYMMDDHHSSZ"
				}
			}
		},
		"subject": {
			"$id": "#/properties/issuer",
			"type": "array of objects",
			"title": "Certificate subject",
			"description": "X.500 Name",
			"items": {
				"$id": "#/properties/issuer/items",
				"type": "object",
				"title": "The Items Schema",
				"required": [ "oid", "value" ],
				"properties": {
					"oid": {
						"$id": "#/properties/issuer/items/properties/oid",
						"type": "array of numbers",
						"title": "Name object identifier",
						"description": "OBJECT IDENTIFIER as an array of integer",
						"examples": [ "[ 2, 5, 4, 6 ]" ]
					},
					"value": {
						"$id": "#/properties/issuer/items/properties/value",
						"type": "string",
						"title": "Name value",
						"examples": [ "BR" ]
					}
				}
			}
		},
		"subjectPublicKeyInfo": {
			"$id": "#/properties/subjectPublicKeyInfo",
			"type": "object",
			"title": "Subject Public Key",
			"description": "SubjectPublicKeyInfo ::=  SEQUENCE { algorithm AlgorithmIdentifier, subjectPublicKey BIT STRING }",
			"required": [ "algorithm", "subjectPublicKey" ],
			"properties": {
				"algorithm": {
					"$id": "#/properties/subjectPublicKeyInfo/properties/algorithm",
					"type": "object",
					"title": "Public key algorithm",
					"required": [ "algorithm" ],
					"properties": {
						"algorithm": {
							"$id": "#/properties/subjectPublicKeyInfo/properties/algorithm/properties/algorithm",
							"type": "array of numbers",
							"title": "Algorithm identifier",
							"description": "OBJECT IDENTIFIER as an array of number",
							"examples": [ "[ 1, 2, 840, 113549, 1, 1, 1 ]" ],
						},
						"parameters": {
							"$id": "#/properties/subjectPublicKeyInfo/properties/algorithm/properties/parameters",
							"type": "any",
							"title": "Algorithm parameters"
						}
					}
				},
				"subjectPublicKey": {
					"$id": "#/properties/subjectPublicKeyInfo/properties/subjectPublicKey",
					"type": "hexadecimal string",
					"title": "Public Key",
					"description": "BIT STRING as an hexadecimal value",
					"examples": [ "5303030313034A0260605604C010302A01D041B4652414E43495356414C444F20414C5645532044412053494C5641" ],
					"pattern": "^([A-F,a-f,0-9]*)$"
				}
			}
		},
		"issuerUniqueID": {
			"$id": "#/properties/issuerUniqueID",
			"type": "hexadecimal string",
			"title": "Certificate issuer identification",
			"description": "BIT STRING as an hexadecimal value",
			"examples": [ "302006082B0601050507030206082B06010505070304060A2B060104018237140202" ],
			"pattern": "^([A-F,a-f,0-9]*)$"
		},
		"subjectUniqueID": {
			"$id": "#/properties/subjectUniqueID",
			"type": "hexadecimal string",
			"title": "Certificate subject identification",
			"description": "BIT STRING as an hexadecimal value",
			"examples": [ "30819BA0170605604C010307A00E040C303030303030303030303030A03D060" ],
			"pattern": "^([A-F,a-f,0-9]*)$"
		},
		"extensions": {
			"$id": "#/properties/extensions",
			"type": "object",
			"title": "The Extensions Schema",
			"required": [ "standard" ],
			"properties": {
				"standard": {
					"$id": "#/properties/extensions/properties/standard",
					"type": "object",
					"title": "Standard Certificate Extensions",
					"required": [
						"authorityKeyIdentifier",
						"keyUsage",
						"subjectAltName",
						"basicConstraints",
						"extKeyUsage",
						"cRLDistributionPoints"
					],
					"properties": {
						"authorityKeyIdentifier": {
							"$id": "#/properties/extensions/properties/standard/properties/authorityKeyIdentifier",
							"type": "hexadecimal string",
							"title": "Authority Key Identifier",
							"description": "OCTET STRING as an hexadecimal value",
							"examples": [ "30168014E3660BD409DA334C9A8FCD3642F2FC9E95A9304C" ],
							"pattern": "^([A-F,a-f,0-9]*)$"
						},
						"subjectKeyIdentifier": {
							"$id": "#/properties/extensions/properties/standard/properties/subjectKeyIdentifier",
							"type": "hexadecimal string",
							"title": "Subject Key Identifier",
							"description": "OCTET STRING as an hexadecimal value",
							"examples": [ "0414E2DA5C1BE7C5F8B48428C42FBF18285ECC0BBE8B" ],
							"pattern": "^([A-F,a-f,0-9]*)$"
						},
						"keyUsage": {
							"$id": "#/properties/extensions/properties/standard/properties/keyUsage",
							"type": "hexadecimal string",
							"title": "Key Usage",
							"description": "KeyUsage ::= BIT STRING { digitalSignature(0), nonRepudiation(1), keyEncipherment(2), dataEncipherment(3), keyAgreement(4), keyCertSign(5), cRLSign(6), encipherOnly(7), decipherOnly(8) } as an hexadecimal number",
							"examples": [ "030205E0" ],
							"pattern": "^([A-F,a-f,0-9]*)$"
						},
						"subjectAltName": {
							"$id": "#/properties/subjectAltName",
							"type": "array",
							"title": "Subject Alternative Names",
							"items": {
								"$id": "#/properties/subjectAltName/items",
								"type": "object",
								"title": "Definition",
								"required": [ "type", "value" ],
								"properties": {
									"type": {
										"$id": "#/properties/subjectAltName/items/properties/type",
										"type": "string",
										"enum": [ "otherName", "rfc822Name", "dNSName", "x400Address", "directoryName", "ediPartyName", "uniformResourceIdentifier", "iPAddress", "registeredID" ],
										"title": "Alternative name type",
										"examples": [ "otherName" ]
									},
									"oid": {
										"$id": "#/properties/subjectAltName/items/properties/oid",
										"type": "array of numbers",
										"title": "Alternative Name OID",
										"description": "OBJECT IDENTIFIER as an array of number",
										"examples": [ "[ 1, 3, 6, 1, 4, 1, 311, 20, 2, 3 ]" ]
									},
									"value": {
										"$id": "#/properties/subjectAltName/items/properties/value",
										"type": "string",
										"title": "Alternative Name value",
										"examples": [ "imyself@microsofot, com" ]
									}
								}
							}
						},
						"basicConstraints": {
							"$id": "#/properties/extensions/properties/standard/properties/basicConstraints",
							"type": "boolean",
							"title": "Basic constraints",
							"description": "BasicConstraints ::= SEQUENCE { cA BOOLEAN DEFAULT FALSE, pathLenConstraint INTEGER (0..MAX) OPTIONAL }",
							"examples": [ "true" ]
						},
						"extKeyUsage": {
							"$id": "#/properties/extensions/properties/standard/properties/extKeyUsage",
							"type": "array of arrays of numbers",
							"title": "Extended Key Usage",
							"description": "ExtKeyUsageSyntax ::= SEQUENCE SIZE (1..MAX) OF OBJECT IDENTIFIER as an array of arrays of number",
							"examples": [ "[[ 1.3.6.1.5.5.7.3.2], [1.3.6.1.5.5.7.3.4]]" ]
						},
						"cRLDistributionPoints": {
							"$id": "#/properties/extensions/properties/standard/properties/cRLDistributionPoints",
							"type": "array of string",
							"title": "CRL Distribution Points",
							"examples": [ "[http://www.caixa.gov.br/tkn/repo, http://www.caixa.gov.br/acs]" ]
						},
						"authorityInfoAccess": {
							"$id": "#/properties/extensions/properties/standard/properties/authorityInfoAccess",
							"type": "array of string",
							"title": "Authority Info Access",
							"examples": [ "[http://www.caixa.gov.br/tkn/aia]" ]
						}
					}
				},
				"extensions": {
					"$id": "#/properties/extensions/properties/extensions",
					"type": "array",
					"title": "Non-standard extensions",
					"items": {
						"$id": "#/properties/extensions/properties/extensions/items",
						"type": "object",
						"title": "Items",
						"required": [ "extnID", "extnValue" ],
					"	properties": {
							"extnID": {
								"$id": "#/properties/extensions/properties/extensions/items/properties/extnID",
								"type": "array of numbers",
								"title": "Extensions OID",
								"description": "OBJECT IDENTIFIER as an array of numbers",
								"examples": [ "[1, 3, 6, 1, 5, 5, 7, 1, 1 ]" ]
							},
							"critical": {
								"$id": "#/properties/extensions/properties/extensions/items/properties/critical",
								"type": "boolean",
								"title": "Critical indicator",
								"default": false,
								"examples": [ "true" ]
							},
							"extnValue": {
								"$id": "#/properties/extensions/properties/extensions/items/properties/extnValue",
								"type": "hexadecimal string",
								"title": "Extension value OCTET STRING as an hexadecimal value",
								"examples": [ "305B305906082B06010505073002864D687474703A2F2F7777772E72656963702E636F726564662E63616978612F7265706F7369746F72696F2F63616465696176322F6169612F6163696370746573746573737562706A76322E703762" ]
							}
						}
					}
				}
			}
		}
	}
}
