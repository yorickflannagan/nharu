<?xml version="1.0" encoding="utf-8"?>
<Project	DefaultTargets="Build"
			ToolsVersion="15.9"
			xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

	<Import Project="targets\project-configurations.targets" />
	<PropertyGroup Label="Globals">
		<VCProjectVersion>15.0</VCProjectVersion>
		<ProjectGuid>{5417FF22-C910-4E01-A161-7AFAF688B0DD}</ProjectGuid>
		<Keyword>StaticLibraryProject</Keyword>
		<RootNamespace>nharu</RootNamespace>
		<WindowsTargetPlatformVersion>10.0.17763.0</WindowsTargetPlatformVersion>
		<NoLogo>true</NoLogo>
	</PropertyGroup>

  	<Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
	<Import Project="targets\staticlib-configurations.targets" />
	<Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
	<ImportGroup Label="ExtensionSettings" />
	<ImportGroup Label="Shared" />
	<Import Project="targets\appdata-platform.targets" />

	<PropertyGroup Label="UserMacros">
		<Home>$(MSBuildProjectDirectory)\..</Home>
		<OpenSSLFolder Condition="'$(OpenSSLFolder)'==''">$(Home)\dist\$(Platform)\ssl</OpenSSLFolder>
		<LibidnFolder Condition="'$(LibidnFolder)'==''">$(Home)\dist\$(Platform)\idn</LibidnFolder>
		<CompileDir Condition="'$(CompileDir)'==''">$(Home)\bin</CompileDir>
		<BuildDir Condition="'$(BuildDir)'==''">$(Home)\dist</BuildDir>
		<Prefix Condition="'$(Prefix)'==''">$(BuildDir)\$(Platform)</Prefix>
		<IntDir>$(CompileDir)\$(Platform)\$(Configuration)\$(ProjectName)\</IntDir>
		<OutDir>$(BuildDir)\$(Platform)\$(Configuration)\$(ProjectName)\</OutDir>
		<IncludeFolders>
			$(Home);
			$(Home)\include;
			$(OpenSSLFolder)\include;
			$(LibidnFolder)\include;
			$(VCInstallDir)\Tools\MSVC\14.16.27023\ATLMFC\include;
			$(VCInstallDir)\Tools\MSVC\14.16.27023\include;
			$(WindowsSdkDir)\include\10.0.17763.0\ucrt;
			$(WindowsSdkDir)\include\10.0.17763.0\shared;
			$(WindowsSdkDir)\include\10.0.17763.0\um;
			$(WindowsSdkDir)\include\10.0.17763.0\winrt;
			$(WindowsSdkDir)\include\10.0.17763.0\cppwinrt
		</IncludeFolders>
		<Warnings>4018;4389;4244;4005;4142;4701;4703;4706</Warnings>
		<Dependencies></Dependencies>
		<TargetSubSystem>Windows</TargetSubSystem>
		<Libraries></Libraries>
		<IsDLL>false</IsDLL>
	</PropertyGroup>

	<Import Project="targets\staticlib-vars.targets" />
	<Import Project="targets\debug.targets" Condition="'$(Configuration)'=='Debug'" />
	<Import Project="targets\release.targets" Condition="'$(Configuration)'=='Release'" />

	<ItemGroup>
		<ClInclude Include="$(Home)\pkcs11\cryptoki.h" />
		<ClInclude Include="$(Home)\pkcs11\pkcs11.h" />
		<ClInclude Include="$(Home)\pkcs11\pkcs11f.h" />
		<ClInclude Include="$(Home)\pkcs11\pkcs11t.h" />
		<ClInclude Include="$(Home)\include\base.h" />
		<ClInclude Include="$(Home)\include\cms.h" />
		<ClInclude Include="$(Home)\include\crypto.h" />
		<ClInclude Include="$(Home)\include\error.h" />
		<ClInclude Include="$(Home)\include\parser.h" />
		<ClInclude Include="$(Home)\include\pki-issue.h" />
		<ClInclude Include="$(Home)\include\pkibr.h" />
		<ClInclude Include="$(Home)\include\pkix.h" />
		<ClInclude Include="$(Home)\include\sysservc.h" />
		<ClInclude Include="$(Home)\src\config.h" />
		<ClInclude Include="$(Home)\src\libgfshare.h" />
		<ClInclude Include="$(Home)\src\libgfshare_tables.h" />
	</ItemGroup>
	<ItemGroup>
		<ClCompile Include="$(Home)\src\cms_env.c" />
		<ClCompile Include="$(Home)\src\cms_sd.c" />
		<ClCompile Include="$(Home)\src\crypto.c" />
		<ClCompile Include="$(Home)\src\issue.c" />
		<ClCompile Include="$(Home)\src\libgfshare.c" />
		<ClCompile Include="$(Home)\src\parser.c" />
		<ClCompile Include="$(Home)\src\pkibr.c" />
		<ClCompile Include="$(Home)\src\pkix.c" />
		<ClCompile Include="$(Home)\src\sysservc.c" />
		<ClCompile Include="$(Home)\src\x509.c" />
	</ItemGroup>

	<Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
	<ImportGroup Label="ExtensionTargets" />
	<Import Project="targets\common.targets" />

	<Target Name="Install">
		<Error Text="Static library must be built first" Condition="!Exists('$(OutDir)$(ProjectName)$(TargetExt)')" />
		<ItemGroup>
			<PKCSFiles Include="$(Home)\pkcs11\*.h" />
			<IncludeFiles Include="$(Home)\include\*.h" />
		</ItemGroup>
		<Copy SourceFiles="@(IncludeFiles)" DestinationFolder="$(Prefix)\nharu\include" />
		<Copy SourceFiles="@(PKCSFiles)" DestinationFolder="$(Prefix)\nharu\pkcs11" />
		<Copy SourceFiles="$(OutDir)$(ProjectName)$(TargetExt)" DestinationFolder="$(Prefix)\nharu\libs" />
		<Copy SourceFiles="$(OutDir)$(ProjectName).pdb" DestinationFolder="$(Prefix)\nharu\libs" />
	</Target>

</Project>