<?xml version="1.0" encoding="UTF-8"  ?>
<configure>

	<!-- run from configure script -->
	<environment scriptfile="nharu-env">

		<!-- Targets -->
		<env name="NHARU_DIR" value="$CURRENT_DIR" />
		<env name="ECLIPSE_WRKSPC" value="$NHARU_DIR/facilities/eclipse" export="false" />
		<env name="JCA_PRJ" value="$NHARU_DIR/jca" export="false" />
		<env name="NHARU_TARGET" value="$NHARU_DIR/libs" export="false" />
		<env name="JCA_TARGET" value="$NHARU_DIR/libs" export="false" />
		<env name="TEST_TARGET" value="$NHARU_DIR/bin" export="false" />

		<!-- Dependencies -->
		<env name="TD_DIR" value="$TRD_DIR" export="false" />
		<env name="OPENSSL_HOME" value="" cmd="dirname $(dirname $(find $TD_DIR -name c_rehash | grep bin))" export="false" />
		<env name="OPENSSL_INCLUDE" value="" cmd="dirname $(dirname $(find $OPENSSL_HOME -name opensslconf.h))" />
		<env name="OPENSSL_LIB" value="" cmd="dirname $(find $OPENSSL_HOME -name libcrypto.a)" />
		<env name="IDN_INCLUDE" value="" cmd="dpkg -L libidn11-dev | grep stringprep\\.h | dirname  $(grep -v xen)" />
		<env name="IDN_DIR" value="" cmd="dpkg -L libidn11-dev | grep libidn\\.a | dirname  $(grep -v xen)" />
		<env name="DLA_DIR" value="" cmd="dpkg -L libc6-dev | grep libdl\\.a | dirname  $(grep -v xen)" />
		<env name="JAVA_HOME" value="" cmd="dirname $(find $TD_DIR -name jdk.tar.gz)" />
		<env name="JAVA_INCLUDE" value="$JAVA_HOME/include" />
		<env name="JAVA_PLATFORM" value="$JAVA_INCLUDE/linux" />
		<env name="ANT_HOME" value="" cmd="dirname $(dirname $(find $TD_DIR -name ant-bootstrap.jar | grep -v eclipse))" />
		<env name="ANT_CONTRIB_LIB" value="" cmd="find $TD_DIR -name ant-contrib.jar" />

		<!-- Paths & environment -->
		<env name="USR_PATH" value="$USR_PATH" export="false" />
		<env name="LD_LIBRARY_PATH" value="$JCA_TARGET" />
		<env name="PATH" value="$JAVA_HOME/bin:$ANT_HOME/bin:$USR_PATH" />
	</environment>

	<resources>
		<dir name="$ECLIPSE_WRKSPC" />
		<dir name="$JCA_PRJ/java-bin" />
		<dir name="$NHARU_TARGET" />
		<dir name="$TEST_TARGET" />
	</resources>

	<tests>
		<test eval="exist_file" value="$OPENSSL_LIB/libcrypto.a" />
		<test eval="exist_file" value="$OPENSSL_INCLUDE/openssl/opensslconf.h" />
		<test eval="exist_file" value="$ANT_CONTRIB_LIB"/>
		<test eval="exist_dir" value="$DLA_DIR" />
		<test eval="exist_dir" value="$IDN_DIR"/>
		<test eval="exist_dir" value="$IDN_INCLUDE"/>
		<test eval="exist_dir" value="$JAVA_HOME"/>
		<test eval="exist_dir" value="$JAVA_INCLUDE"/>
		<test eval="exist_dir" value="$JAVA_PLATFORM"/>
		<test eval="exist_dir" value="$ANT_HOME"/>
		<test eval="echo_cmd" value="$OPENSSL_HOME/bin/openssl version"/>
		<test eval="echo_cmd" value="$JAVA_HOME/bin/java -version"/>
		<test eval="echo_cmd" value="$ANT_HOME/bin/ant -version"/>
	</tests>

	<projects>
		
		<project name="jca-provider" dir="$ECLIPSE_WRKSPC/jca-provider" out="bin">
			<sources native="$JCA_TARGET">
				<source dir="$JCA_PRJ/java" />
			</sources>
			<preferences	version="1" 
						inlineJsrBytecode="enabled" 
						unusedLocal="preserve"
						targetPlatform="1.7" 
						compliance="1.7" 
						lineNumber="generate"
						localVariable="generate"
						sourceFile="generate"
						assertIdentifier="error" 
						enumIdentifier="error" 
						source="1.7" />
		</project>

	</projects>
</configure>

